/*!
 * jQuery FancyRox v0.4
 * 2017-05-16
 *
 * Copyright (c) 2017 Pavel Tzonkov <sunhater@sunhater.com>
 * Dual licensed under the MIT and GPL licenses.
 */
(function(g){var b={};var e={rel:null,index:null};var h=false;var a=function(m){if(/^0*(\d+)(ms)?$/.test(m)){return parseInt(m.replace(/^0*(\d+)(ms)?$/,"$1"))}else{if(/^0*((\d+)(\.\d+)?)(s)?$/.test(m)){return parseInt(parseFloat(m.replace(/^0*((\d+)(\.\d+)?)(s)?$/,"$1"))*1000)}else{return 0}}};var f={show:function(){var m=g("#fancyrox-overlay");m.css({display:"block"});setTimeout(function(){m.addClass("fancyrox-overlay-toggle")},0);g("body").css({overflow:"hidden"}).on("touchmove.fancyrox mousewheel.fancyrox scroll.fancyrox",false).on("keydown.fancyrox",function(u){if(h){return}if(u.key=="Escape"){f.hide();return}var q=/^Arrow(Up|Down|Left|Right)$/;if(q.test(u.key)&&(e.rel!==null)){var n=e.rel,o=e.index,t=g("#"+i.getId(n,o)),s=u.key.replace(q,"$1").toLowerCase();if((b[n]===undefined)||(b[n].length<2)||!t.hasClass("fancyrox-stopped")){return}if((s=="left")||(s=="up")){t.removeClass("fancyrox-active");var r=o-1;if(r<0){r=b[n].length-1}i.show(n,r,s);i.hide(n,o,s)}else{t.removeClass("fancyrox-active");var p=o+1;if(p>b[n].length-1){p=0}i.show(n,p,s);i.hide(n,o,s)}}})},hide:function(){var m=g("#fancyrox-overlay"),o=a(m.css("transition-duration"));m.removeClass("fancyrox-overlay-toggle");setTimeout(function(){m.css({display:"none"})},o);var n=g(".fancyrox-box").removeClass("fancyrox-box-toggle fancyrox-stopped fancyrox-active");o=a(n.css("transition-duration"));setTimeout(function(){n.hide();g(".fancyrox-box .fancyrox-viewport").each(function(){var r=g(this).parents(".fancyrox-box"),q=r.find(".fancyrox-box-content"),p=r.data("slide");if(p.type=="video"){if(typeof c.providers[p.provider].pause=="function"){c.providers[p.provider].pause(r)}else{g(this).remove();q.append(g(p.embed).addClass("fancyrox-viewport"))}}})},o);g("body").css({overflow:"visible"}).off("keydown.fancyrox touchmove.fancyrox mousewheel.fancyrox scroll.fancyrox")}};g(function(){if(!g("#fancyrox-overlay").length){g("body").append('<div id="fancyrox-overlay"></div>');g("#fancyrox-overlay").click(f.hide)}});var c={providers:{youtube:{check:[{expr:/^https?:\/\/(www\.)?youtube\.com\/watch\?v=([^&]+).*$/,match:2},{expr:/^https?:\/\/youtu\.be\/([^\?#]+).*$/,match:1}],pause:function(m){m.find("iframe.fancyrox-viewport").get(0).contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*")},play:function(m){m.find("iframe.fancyrox-viewport").get(0).contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}',"*")},embed:'<iframe src="https://www.youtube.com/embed/{id}?enablejsapi=1" frameborder="0" style="overflow:hidden;height:100%;width:100%" height="100%" width="100%" allowfullscreen></iframe>'}},getInfo:function(n){for(var o in this.providers){provider=this.providers[o];if(provider.check.constructor===Array){for(var m in provider.check){m=provider.check[m];if(m.expr.test(n)){return{provider:o,embed:provider.embed.replace("{id}",n.replace(m.expr,"$"+m.match))}}}}else{if(provider.check.expr.test(n)){return{provider:o,embed:provider.embed.replace("{id}",n.replace(provider.check.expr,"$"+provider.check.match))}}}}return false}};var l=function(A){var x,u,G,E,s=Math.max(document.documentElement.clientWidth,window.innerWidth||0),z=Math.max(document.documentElement.clientHeight,window.innerHeight||0),m=A.data("slide"),r=A.find(".fancyrox-box-content"),v=A.find(".fancyrox-box-title"),C=r.outerWidth()-r.width(),t=r.outerHeight()-r.height(),y=v.length?v.outerHeight()+parseInt(v.css("margin-top")):0;if(s>80){s-=80}if(z>80){z-=80}if(m.type=="image"){var B=m.width+C,o=m.height+t+y;k=m.width/m.height;if((B<s)&&(o<z)){x=m.width+C;u=m.height}else{if((s/B)<(z/o)){x=s;u=(s-C)/k}else{u=z-y-t;x=(u*k)+C}}}else{var F=g(m.caller).data(),q=/^([1-9]\d*)x([1-9]\d*)$/;if((F.size!==undefined)&&(q.test(F.size))){x=parseInt(F.size.replace(q,"$1"))+C;u=parseInt(F.size.replace(q,"$2"))}else{if((F.aspect!==undefined)&&(q.test(F.aspect))){var D=parseInt(F.aspect.replace(q,"$1")),p=parseInt(F.aspect.replace(q,"$2")),n=s/z;k=D/p;if(k>n){x=s;u=(s-C)/k}else{u=z-y-t;x=(u*k)+C}}else{x=s;u=z-y-t}}}G=-((u+t+y)/2);E=-(x/2);return{left:E,top:G,width:x,height:u}};var d=function(){var n=g(".fancyrox-box.fancyrox-active");if(!n.length){return}var m=l(n);n.css({width:m.width,height:m.height,marginLeft:m.left,marginTop:m.top})};var j=0;g(window).on("resize.fancyrox",function(){j++;var m=g(".fancyrox-box.fancyrox-active").addClass("fancyrox-no-transition");d();setTimeout(function(){j--;if(!j){m.removeClass("fancyrox-no-transition")}},250)});var i={getId:function(m,n){return"fancyrox-box-"+m+"-"+n},render:function(n,o){if((typeof b[n]==="undefined")||(typeof b[n][o]==="undefined")){return false}var q,m=b[n][o],r=this.getId(n,o),p=g("#"+r);if(p.length){return true}p=g('<div class="fancyrox-box"><div class="fancyrox-box-top"><i class="fancyrox-box-close"></i></div><div class="fancyrox-box-content"><div class="fancyrox-box-prev"><b></b></div><div class="fancyrox-box-next"><b></b></div></div><div class="fancyrox-box-title"></div></div>');p.attr({id:r}).data({rel:n,index:o,slide:m}).addClass("fancyrox-box-type-"+m.type);if(m.type=="image"){q=g(m.image).attr({draggable:false})}else{if(m.embed!==undefined){q=g(m.embed)}}q.addClass("fancyrox-viewport");p.find(".fancyrox-box-content").append(q);p.find(".fancyrox-box-close").click(function(){if(!h){f.hide()}});p.find(".fancyrox-box-prev").click(function(){if(h||(b[n].length<2)){return}p.removeClass("fancyrox-active");var s=o-1;if(s<0){s=b[n].length-1}i.show(n,s,"left");i.hide(n,o,"left")});p.find(".fancyrox-box-next").click(function(){if(h||(b[n].length<2)){return}p.removeClass("fancyrox-active");var s=o+1;if(s>b[n].length-1){s=0}i.show(n,s,"right");i.hide(n,o,"right")});if(g.fn.swipe!==undefined){p.swipe({swipe:function(t,u){if((b[n].length<2)||!p.hasClass("fancyrox-stopped")){return}var s;p.removeClass("fancyrox-active");if((u=="left")||(u=="up")){s=o+1;if(s>b[n].length-1){s=0}}else{s=o-1;if(s<0){s=b[n].length-1}}if(u=="up"){u="down"}else{if(u=="down"){u="up"}else{if(u=="left"){u="right"}else{u="left"}}}i.show(n,s,u);i.hide(n,o)},swipeStatus:function(v,s,w,y){if(b[n].length<2){return}var u=l(p);if(s=="move"){h=true;var t=u.top,x=u.left;if(w=="right"){x+=y}else{if(w=="left"){x-=y}else{if(w=="down"){t+=y}else{if(w=="up"){t-=y}}}}p.addClass("fancyrox-no-transition").css({marginTop:t,marginLeft:x})}else{if((s=="end")||(s=="cancel")){setTimeout(function(){h=false},100);p.removeClass("fancyrox-no-transition");if(s=="cancel"){p.css({marginTop:u.top,marginLeft:u.left})}}}},threshold:20,allowPageScroll:"none"})}if(!m.title){p.find(".fancyrox-box-title").remove()}else{p.find(".fancyrox-box-title").html(m.title)}g("body").append(p);return p},show:function(n,p,s){if((typeof b[n]==="undefined")||(typeof b[n][p]==="undefined")){return false}var m=b[n][p],t=this.getId(n,p),r=g("#"+t);if(b[n].length==1){r.find(".fancyrox-box-prev").remove();r.find(".fancyrox-box-next").remove()}if(!r.length){return false}var o=function(){g("fancyrox-box").removeClass("fancyrox-active");r.show().addClass("fancyrox-active");e.rel=n;e.index=p;d();if(s!==undefined){var v=parseInt(r.css("margin-left")),u=parseInt(r.css("margin-top"));if(s=="left"){v-=100}else{if(s=="right"){v+=100}else{if(s=="up"){u-=100}else{if(s=="down"){u+=100}}}}r.css({marginLeft:v,marginTop:u});setTimeout(d,0)}setTimeout(function(){r.addClass("fancyrox-box-toggle");if(m.type=="video"){var x=!!g(m.caller).data("autoplay");if(x&&(typeof c.providers[m.provider].play=="function")){c.providers[m.provider].play(r)}}var w=a(r.css("transition-duration"));setTimeout(function(){r.addClass("fancyrox-stopped")},w)},0)};if(!m.loaded){var q=setInterval(function(){if(!b[n][p].loaded){return}o();clearInterval(q)},10)}else{o()}},hide:function(u,s,t){if((typeof b[u]==="undefined")||(typeof b[u][s]==="undefined")){return false}var r=b[u][s],o=this.getId(u,s),m=g("#"+o);if(!m.length){return false}m.removeClass("fancyrox-active fancyrox-stopped");if((r.type=="video")&&(typeof c.providers[r.provider].pause=="function")){c.providers[r.provider].pause(m)}m.addClass("fancyrox-box-hide-direction");var q=a(m.css("transition-duration"));if(t!==undefined){var p=parseInt(m.css("margin-left")),n=parseInt(m.css("margin-top"));if(t=="left"){p+=100}else{if(t=="right"){p-=100}else{if(t=="up"){n+=100}else{if(t=="down"){n-=100}}}}m.css({marginLeft:p,marginTop:n})}setTimeout(function(){m.removeClass("fancyrox-box-toggle fancyrox-box-hide-direction");m.hide()},q)}};g.fn.fancyrox=function(){g(this).each(function(){if(g(this).is("a")){var o=g(this).attr("href"),m=g(this).attr("rel"),r=g(this).data("title");if(o===undefined){return}if(r===undefined){r=g(this).attr("title");if(r===undefined){r=false}else{g(this).removeAttr("title")}}if(m===undefined){m="_undefined_"}if(typeof b[m]=="undefined"){b[m]=[]}var p=b[m].length,q={url:o,caller:this,loaded:false,title:r};var n=new Image();n.src=o;n.onload=function(){g(n).addClass("fancyrox-init-image");g("body").append(g(n));b[m][p].loaded=true;b[m][p].type="image";b[m][p].image=n;b[m][p].width=n.clientWidth;b[m][p].height=n.clientHeight;g(n).removeClass("fancyrox-init-image").detach();i.render(m,p)};n.onerror=function(){var u,t=c.getInfo(o);if(t===false){var s=g("<iframe />").attr({src:o,frameborder:"0",width:"100%",height:"100%"}).css({overflow:"hidden",height:"100%",width:"100%"});u=g("<div />").append(s).html();type="iframe"}else{u=t.embed;type="video";b[m][p].provider=t.provider}b[m][p].loaded=true;b[m][p].type=type;b[m][p].embed=u;i.render(m,p)};b[m].push(q);g(this).data({fancyroxIndex:p})}});g(this).click(function(){var m=g(this).attr("rel");if(m===undefined){m="_undefined_"}var n=g(this).data("fancyroxIndex");if(n===undefined){return false}var p=i.getId(m,n),o=g("#"+p);if(!o.length){return false}f.show();i.show(m,n);return false})}})(jQuery);